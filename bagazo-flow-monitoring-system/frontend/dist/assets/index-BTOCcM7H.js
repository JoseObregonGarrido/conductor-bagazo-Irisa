import{j as e,r as t,R as M,a as B}from"./vendor-react-D_7EDXj9.js";import{S as I,C as k,P as O,W as F,A as H,D as q,O as W,G as $,a as G,B as V,V as P}from"./vendor-three-Dq0513u4.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function u(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=u(n);fetch(n.href,a)}})();function v(){return e.jsx("header",{className:"header",children:e.jsxs("div",{className:"header-container",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{className:"header-title",children:"Sistema de Monitoreo - Conductores de Bagazo"}),e.jsx("p",{className:"header-subtitle",children:"Sistema de Monitoreo - Conductores de Bagazo"})]}),e.jsx("div",{className:"header-info",children:e.jsx("span",{className:"badge",children:"IRISA S.A.S."})})]})})}function T(){const r=t.useRef(null),d=t.useRef(null),u=t.useRef(null),i=t.useRef(null),n=t.useRef(null),a=t.useRef(null),s=t.useRef(null);return t.useEffect(()=>{if(!r.current)return;const m=new I;m.background=new k(988970),d.current=m;const x=r.current.clientWidth,j=r.current.clientHeight,o=new O(75,x/j,.1,1e3);o.position.set(0,2,3),u.current=o;const c=new F({antialias:!0});c.setSize(x,j),c.setPixelRatio(window.devicePixelRatio),r.current.appendChild(c.domElement),i.current=c;const z=new H(16777215,.8);m.add(z);const C=new q(16777215,.9);C.position.set(5,5,5),m.add(C);const h=new W(o,c.domElement);h.enableDamping=!0,h.dampingFactor=.05,h.autoRotate=!0,h.autoRotateSpeed=2,n.current=h;const S=new $,b=new G;b.setDecoderPath("/draco-gltf/"),S.setDRACOLoader(b),S.load("/model/modelo-3d-comprimido.glb",l=>{const f=l.scene;f.scale.set(1.15,1.15,1.15),m.add(f),s.current=f;const p=new V().setFromObject(f),g=p.getCenter(new P),N=p.getSize(new P),A=Math.max(N.x,N.y,N.z),D=o.fov*(Math.PI/180);let E=Math.abs(A/2/Math.tan(D/2));E*=1.12,o.position.z=E,o.position.x=g.x,o.position.y=g.y+A*.18,o.lookAt(g),h.target.copy(g),h.update()});const y=()=>{a.current=requestAnimationFrame(y),h.update(),c.render(m,o)};y();const R=()=>{if(!r.current)return;const l=r.current.clientWidth,f=r.current.clientHeight;o.aspect=l/f,o.updateProjectionMatrix(),c.setSize(l,f)};return window.addEventListener("resize",R),()=>{a.current&&cancelAnimationFrame(a.current),window.removeEventListener("resize",R),m.traverse(l=>{l.isMesh&&(l.geometry&&l.geometry.dispose(),l.material&&(Array.isArray(l.material)?l.material:[l.material]).forEach(p=>{p.map&&p.map.dispose(),p.dispose()}))}),c.dispose(),r.current&&c.domElement.parentNode===r.current&&r.current.removeChild(c.domElement)}},[]),e.jsxs("div",{className:"model3d-container",children:[e.jsx("div",{ref:r,className:"model3d-viewer"}),e.jsx("div",{className:"model3d-info",children:e.jsx("p",{children:"Usa el mouse para rotar o su pantalla táctil | Scroll para zoom o pellizcar para acercar/alejar"})})]})}function U({puntos:r,onPuntoClick:d}){const[u,i]=t.useState(null),n=s=>({red:"#B81D1D",green:"#006B42",yellow:"#A06000",blue:"#1B4965"})[s]||"#B81D1D",a=s=>{i(s.id),d?.(s)};return e.jsxs("div",{className:"diagram-container",children:[e.jsx("h2",{className:"diagram-title",children:"Conductores de Bagazo"}),e.jsxs("div",{className:"diagram-content",children:[e.jsx("div",{className:"diagram-image-wrapper",children:e.jsx(T,{})}),e.jsxs("div",{className:"diagram-legend",children:[e.jsx("p",{className:"legend-title",children:"Selecciona un conductor para ver los detalles:"}),e.jsx("div",{className:"legend-items",role:"group","aria-label":"Conductores",children:r.map(s=>e.jsx("button",{className:`legend-item ${u===s.id?"active":""}`,style:{backgroundColor:n(s.color)},onClick:()=>a(s),title:s.nombre,"aria-label":`Conductor ${s.nombre}`,"aria-pressed":u===s.id,children:e.jsx("span",{className:"legend-number",children:s.nombre})},s.id))})]})]}),e.jsx("p",{className:"diagram-hint",children:"Haz clic en cualquier conductor para ver la información completa"})]})}function Y({punto:r,onClose:d}){const[u,i]=t.useState(!1);return t.useEffect(()=>{r&&(i(!1),setTimeout(()=>{i(!0)},50))},[r?.id]),r?e.jsxs("div",{className:`info-panel ${u?"animated":""}`,children:[e.jsxs("div",{className:"info-header",children:[e.jsx("div",{className:"punto-badge",style:{backgroundColor:r.color},children:r.nombre}),e.jsx("button",{className:"close-button",onClick:d,title:"Cerrar",children:"✕"})]}),e.jsx("div",{className:"info-content",children:e.jsx("div",{className:"info-section",children:e.jsx("p",{className:"info-description",children:r.descripcion})})}),e.jsx("div",{className:"info-content",children:e.jsx("div",{className:"info-section",children:e.jsx("p",{className:"info-description",children:r.tipo})})})]}):e.jsx("div",{className:"info-panel",children:e.jsxs("div",{className:"info-empty",children:[e.jsx("h3",{children:"Selecciona un Conductor"}),e.jsx("p",{children:"Haz clic en cualquier conductor (C1 a C12) de la leyenda para ver su descripción."})]})})}function w(){const r=new Date().getFullYear();return e.jsx("footer",{className:"footer",children:e.jsxs("div",{className:"footer-container",children:[e.jsx("div",{className:"footer-content",children:e.jsxs("div",{className:"footer-info",children:[e.jsxs("p",{className:"footer-text",children:["© ",r," Sistema Conductores de Bagazo - IRISA S.A.S."]}),e.jsx("p",{className:"footer-subtitle",children:"Sistema de Monitoreo - Conductores de Bagazo"})]})}),e.jsx("div",{className:"footer-divider"}),e.jsx("div",{className:"footer-credits",children:e.jsxs("p",{className:"footer-credits-text",children:["|",e.jsx("a",{href:"https://www.ingeniorisaralda.com/es/",className:"footer-link",children:" IRISA S.A.S "})," |",e.jsx("a",{href:"#",className:"footer-link",children:" La Virginia "})]})})]})})}const L="http://localhost:5000/api",_=async()=>{try{const r=await fetch(`${L}/puntos`);if(!r.ok)throw new Error("Error al obtener los puntos");return await r.json()}catch(r){throw console.error("Error en obtenerPuntos:",r),r}},K=async()=>{try{const r=await fetch(`${L.replace("/api","")}/api/health`);if(!r.ok)throw new Error("Backend no disponible");return await r.json()}catch(r){throw console.error("Error al conectar con el backend:",r),r}};function Z(){const[r,d]=t.useState([]),[u,i]=t.useState(null),[n,a]=t.useState(!0),[s,m]=t.useState(null);t.useEffect(()=>{(async()=>{try{await K();const c=await _();d(c),m(null)}catch{m("No se pudo conectar con el backend. Asegúrate de que esté ejecutándose en el puerto 5000.")}finally{a(!1)}})()},[]);const x=o=>{i(o)},j=()=>{i(null)};return n?e.jsxs("div",{className:"app",children:[e.jsx(v,{}),e.jsx("main",{className:"main-content",children:e.jsxs("div",{className:"loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Cargando datos..."})]})}),e.jsx(w,{})]}):s?e.jsxs("div",{className:"app",children:[e.jsx(v,{}),e.jsx("main",{className:"main-content",children:e.jsxs("div",{className:"error",children:[e.jsx("h2",{children:"⚠️ Error de Conexión"}),e.jsx("p",{children:s}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Intentar de nuevo"})]})}),e.jsx(w,{})]}):e.jsxs("div",{className:"app",children:[e.jsx(v,{}),e.jsx("main",{className:"main-content",children:e.jsxs("div",{className:"content-grid",children:[e.jsx("div",{className:"diagram-section",children:r.length>0?e.jsx(U,{puntos:r,onPuntoClick:x}):e.jsx("p",{className:"no-data",children:"No hay datos disponibles"})}),e.jsx("div",{className:"info-section",children:e.jsx(Y,{punto:u,onClose:j})})]})}),e.jsx(w,{})]})}M.createRoot(document.getElementById("root")).render(e.jsx(B.StrictMode,{children:e.jsx(Z,{})}));
