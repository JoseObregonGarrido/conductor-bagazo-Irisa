const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Diagram-B5P9DQBk.js","assets/vendor-react-D_7EDXj9.js","assets/vendor-three-Dq0513u4.js","assets/Diagram-D3976avp.css"])))=>i.map(i=>d[i]);
import{j as e,r as m,R as S,a as y}from"./vendor-react-D_7EDXj9.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))h(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const t of r.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&h(t)}).observe(document,{childList:!0,subtree:!0});function u(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function h(n){if(n.ep)return;n.ep=!0;const r=u(n);fetch(n.href,r)}})();const b="modulepreload",w=function(s){return"/"+s},x={},E=function(d,u,h){let n=Promise.resolve();if(u&&u.length>0){let f=function(a){return Promise.all(a.map(i=>Promise.resolve(i).then(l=>({status:"fulfilled",value:l}),l=>({status:"rejected",reason:l}))))};document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),o=t?.nonce||t?.getAttribute("nonce");n=f(u.map(a=>{if(a=w(a),a in x)return;x[a]=!0;const i=a.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${l}`))return;const c=document.createElement("link");if(c.rel=i?"stylesheet":b,i||(c.as="script"),c.crossOrigin="",c.href=a,o&&c.setAttribute("nonce",o),document.head.appendChild(c),i)return new Promise((v,g)=>{c.addEventListener("load",v),c.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})}))}function r(t){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=t,window.dispatchEvent(o),!o.defaultPrevented)throw t}return n.then(t=>{for(const o of t||[])o.status==="rejected"&&r(o.reason);return d().catch(r)})};function p(){return e.jsx("header",{className:"header",children:e.jsxs("div",{className:"header-container",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{className:"header-title",children:"Sistema de Monitoreo - Conductores de Bagazo"}),e.jsx("p",{className:"header-subtitle",children:"Sistema de Monitoreo - Conductores de Bagazo"})]}),e.jsx("div",{className:"header-info",children:e.jsx("span",{className:"badge",children:"IRISA S.A.S."})})]})})}function C({punto:s,onClose:d}){const[u,h]=m.useState(!1);return m.useEffect(()=>{s&&(h(!1),setTimeout(()=>{h(!0)},50))},[s?.id]),s?e.jsxs("div",{className:`info-panel ${u?"animated":""}`,children:[e.jsxs("div",{className:"info-header",children:[e.jsx("div",{className:"punto-badge",style:{backgroundColor:s.color},children:s.nombre}),e.jsx("button",{className:"close-button",onClick:d,title:"Cerrar",children:"✕"})]}),e.jsx("div",{className:"info-content",children:e.jsx("div",{className:"info-section",children:e.jsx("p",{className:"info-description",children:s.descripcion})})}),e.jsx("div",{className:"info-content",children:e.jsx("div",{className:"info-section",children:e.jsx("p",{className:"info-description",children:s.tipo})})})]}):e.jsx("div",{className:"info-panel",children:e.jsxs("div",{className:"info-empty",children:[e.jsx("h3",{children:"Selecciona un Conductor"}),e.jsx("p",{children:"Haz clic en cualquier conductor (C1 a C12) de la leyenda para ver su descripción."})]})})}function j(){const s=new Date().getFullYear();return e.jsx("footer",{className:"footer",children:e.jsxs("div",{className:"footer-container",children:[e.jsx("div",{className:"footer-content",children:e.jsxs("div",{className:"footer-info",children:[e.jsxs("p",{className:"footer-text",children:["© ",s," Sistema Conductores de Bagazo - IRISA S.A.S."]}),e.jsx("p",{className:"footer-subtitle",children:"Sistema de Monitoreo - Conductores de Bagazo"})]})}),e.jsx("div",{className:"footer-divider"}),e.jsx("div",{className:"footer-credits",children:e.jsxs("p",{className:"footer-credits-text",children:["|",e.jsx("a",{href:"https://www.ingeniorisaralda.com/es/",className:"footer-link",children:" IRISA S.A.S "})," |",e.jsx("a",{href:"#",className:"footer-link",children:" La Virginia "})]})})]})})}const N="http://localhost:5000/api",P=async()=>{try{const s=await fetch(`${N}/puntos`);if(!s.ok)throw new Error("Error al obtener los puntos");return await s.json()}catch(s){throw console.error("Error en obtenerPuntos:",s),s}},A=async()=>{try{const s=await fetch(`${N.replace("/api","")}/api/health`);if(!s.ok)throw new Error("Backend no disponible");return await s.json()}catch(s){throw console.error("Error al conectar con el backend:",s),s}},R=m.lazy(()=>E(()=>import("./Diagram-B5P9DQBk.js"),__vite__mapDeps([0,1,2,3])));function k(){const[s,d]=m.useState([]),[u,h]=m.useState(null),[n,r]=m.useState(!0),[t,o]=m.useState(null);m.useEffect(()=>{const i=async(l=3)=>{try{await A();const c=await P();d(c),o(null)}catch(c){l>0?(console.warn(`Error al conectar. Reintentando en 2 segundos... (${l} reintentos restantes)`),setTimeout(()=>i(l-1),2e3)):(console.error("Error al cargar datos después de reintentos:",c),o("No se pudo conectar con el backend. Asegúrate de que esté ejecutándose en el puerto 5000."),r(!1))}finally{(l===3||t)&&r(!1)}};i()},[t]);const f=i=>{h(i)},a=()=>{h(null)};return n?e.jsxs("div",{className:"app",children:[e.jsx(p,{}),e.jsx("main",{className:"main-content",children:e.jsxs("div",{className:"loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Cargando datos iniciales..."})]})}),e.jsx(j,{})]}):t?e.jsxs("div",{className:"app",children:[e.jsx(p,{}),e.jsx("main",{className:"main-content",children:e.jsxs("div",{className:"error",children:[e.jsx("h2",{children:"Error de Conexión"}),e.jsx("p",{children:t}),e.jsx("button",{onClick:()=>window.location.reload(),className:"p-3 bg-blue-500 text-white rounded-lg shadow-md hover:bg-blue-600 transition",children:"Intentar de nuevo"})]})}),e.jsx(j,{})]}):e.jsxs("div",{className:"app",children:[e.jsx(p,{}),e.jsx("main",{className:"main-content",children:e.jsxs("div",{className:"content-grid",children:[e.jsx("div",{className:"diagram-section",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"loading-3d",children:"Cargando la visualización 3D..."}),children:s.length>0?e.jsx(R,{puntos:s,onPuntoClick:f}):e.jsx("p",{className:"no-data",children:"No hay datos disponibles"})})}),e.jsx("div",{className:"info-section",children:e.jsx(C,{punto:u,onClose:a})})]})}),e.jsx(j,{})]})}S.createRoot(document.getElementById("root")).render(e.jsx(y.StrictMode,{children:e.jsx(k,{})}));
