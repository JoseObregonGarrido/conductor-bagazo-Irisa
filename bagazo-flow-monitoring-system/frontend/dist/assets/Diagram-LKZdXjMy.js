import{r as c,j as t}from"./vendor-react-D_7EDXj9.js";import{S as y,C as F,P as B,W as T,A as k,D as O,O as W,G as H,a as G,B as I,V as L}from"./vendor-three-Dq0513u4.js";function q(){const n=c.useRef(null),p=c.useRef(null),g=c.useRef(null),l=c.useRef(null),f=c.useRef(null),h=c.useRef(null),r=c.useRef(null),m=c.useRef(null);return c.useEffect(()=>{if(!n.current)return;const u=new y;u.background=new F(988970),p.current=u;const v=n.current.clientWidth,R=n.current.clientHeight,a=new B(58,v/R,.1,1e3);a.position.set(1,8,14),g.current=a;const d=new T({antialias:!0,powerPreference:"high-performance",stencil:!1,depth:!0});d.setSize(v,R),d.setPixelRatio(Math.min(window.devicePixelRatio,2)),n.current.appendChild(d.domElement),l.current=d;const E=new k(16777215,.8);u.add(E);const M=new O(16777215,.9);M.position.set(5,5,5),u.add(M);const i=new W(a,d.domElement);i.enableDamping=!0,i.dampingFactor=.05,i.autoRotate=!0,i.autoRotateSpeed=2,i.maxPolarAngle=Math.PI/1.8,i.minDistance=3,i.maxDistance=50,f.current=i;const C=new H,D=new G;D.setDecoderPath("/draco-gltf/"),C.setDRACOLoader(D),C.load("/model/modelo-3d-comprimido.glb",e=>{const s=e.scene;s.scale.set(.8,.8,.8),u.add(s),r.current=s;const o=new I().setFromObject(s),x=o.getCenter(new L),w=o.getSize(new L),P=Math.max(w.x,w.y,w.z),S=a.fov*(Math.PI/180);let A=Math.abs(P/2/Math.tan(S/2));A*=4.5,a.position.z=A,a.position.x=x.x,a.position.y=x.y+P*.4,a.lookAt(x),i.target.copy(x),i.update()},void 0,e=>{console.error("Error al cargar el modelo 3D:",e)});let b=performance.now();const j=1e3/60,z=e=>{h.current=requestAnimationFrame(z);const s=e-b;s<j||(b=e-s%j,i.update()&&d.render(u,a))};z(performance.now());const N=()=>{m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{if(!n.current)return;const e=n.current.clientWidth,s=n.current.clientHeight;Math.abs(a.aspect-e/s)>.01&&(a.aspect=e/s,a.updateProjectionMatrix(),d.setSize(e,s,!1))},150)};return window.addEventListener("resize",N,{passive:!0}),()=>{h.current&&cancelAnimationFrame(h.current),m.current&&clearTimeout(m.current),window.removeEventListener("resize",N),p.current&&p.current.traverse(e=>{e.isMesh&&(e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material:[e.material]).forEach(o=>{o.map&&o.map.dispose(),o.normalMap&&o.normalMap.dispose(),o.roughnessMap&&o.roughnessMap.dispose(),o.metalnessMap&&o.metalnessMap.dispose(),o.dispose()}))}),l.current&&l.current.dispose(),f.current&&f.current.dispose(),n.current&&l.current?.domElement?.parentNode===n.current&&n.current.removeChild(l.current.domElement)}},[]),t.jsxs("div",{className:"model3d-container",children:[t.jsx("div",{ref:n,className:"model3d-viewer"}),t.jsx("div",{className:"model3d-info",children:t.jsx("p",{children:"Usa el mouse para rotar o su pantalla táctil | Scroll para zoom o pellizcar para acercar/alejar"})})]})}function Z({puntos:n,onPuntoClick:p}){const[g,l]=c.useState(null),f=r=>({red:"#B81D1D",green:"#006B42",yellow:"#A06000",blue:"#1B4965"})[r]||"#B81D1D",h=r=>{l(r.id),p?.(r)};return t.jsxs("div",{className:"diagram-container",children:[t.jsx("h2",{className:"diagram-title",children:"Conductores de Bagazo"}),t.jsxs("div",{className:"diagram-content",children:[t.jsx("div",{className:"diagram-image-wrapper",children:t.jsx(q,{})}),t.jsxs("div",{className:"diagram-legend",children:[t.jsx("p",{className:"legend-title",children:"Selecciona un conductor para ver los detalles:"}),t.jsx("div",{className:"legend-items",role:"group","aria-label":"Conductores",children:n.map(r=>t.jsx("button",{className:`legend-item ${g===r.id?"active":""}`,style:{backgroundColor:f(r.color)},onClick:()=>h(r),title:r.nombre,"aria-label":`Conductor ${r.nombre}`,"aria-pressed":g===r.id,children:t.jsx("span",{className:"legend-number",children:r.nombre})},r.id))})]})]}),t.jsx("p",{className:"diagram-hint",children:"Haz clic en cualquier conductor para ver la información completa"})]})}export{Z as default};
